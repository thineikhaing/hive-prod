%div{style:"margin-left:80px"}
  = image_tag("CarMask.png",alt: "CarMask",style: 'width:30px;' )
  = image_tag("CarMask.png",alt: "CarMask",style: 'width:30px;background:red;' )
  = image_tag("CarMask.png",alt: "CarMask",style: 'width:30px;background:green' )
  = image_tag("CarMask.png",alt: "CarMask",style: 'width:30px;background:orange' )
  = image_tag("CarMask.png",alt: "CarMask",style: 'width:30px;background:blue' )

%div.carmic_map
  #map


:javascript
   //Carmic.init();

   //setInterval(function() {
   //    //call $.ajax here
   //
   //
   //    console.log("it's me")
   //}, 5000); //5 seconds


          //if(navigator.geolocation)
               //    navigator.geolocation.getCurrentPosition(displayOnMap);


      //function displayOnMap(position){
      //  var marker = handler.addMarker({
      //    lat: position.coords.latitude,
      //    lng: position.coords.longitude
      //  });
      //  //handler.map.centerOn(marker);
      //
      //  handler.bounds.extendWith(marker);
      //  handler.fitMapToBounds();
      //};

     /*
      var map;
      var path;
      var marker;

      function initialize() {
          var myLatlng = new google.maps.LatLng(1.317907, 103.843643);
          var myOptions = {
              zoom: 15,
              center: myLatlng
          }

          map = new google.maps.Map(document.getElementById("map"), myOptions);

          marker = new google.maps.Marker({
              position: new google.maps.LatLng(1.317907,103.843643),
              map: map
          });

          counter = 0;
          interval = window.setInterval(function () {
              counter++;
              var pos = new google.maps.LatLng(1.317907,103.843643 + counter / 100000);
              marker.setPosition(pos);
              if (counter >= 1000) {
                  window.clearInterval(interval);
              }
          }, 10);
      }


      google.maps.event.addDomListener(window, 'load', initialize);
      */

      handler = Gmaps.build('Google');

      handler.buildMap({ provider: {zoom: 13}, internal: {id: 'map'}}, function(){
      var markers = handler.addMarkers(#{raw @hash.to_json});
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();
      handler.getMap().setZoom(13);
      });

      function getCoords(){

        $.ajax({
          type: 'GET',
          url: "http://localhost:5000/api/downloaddata/retrieve_carmic_user",
          success: function(data){
              console.log("set marker// should replace")

               var markers = handler.addMarkers(data.marker);
                              handler.bounds.extendWith(markers);
          }
        });   /*

        $.ajax({
          success: function(html) {
          console.log("call carmic")
          console.log('#{raw @hash.to_json}');

          var markers = handler.addMarkers(#{raw @hash.to_json});
                handler.bounds.extendWith(markers);
                handler.fitMapToBounds();

          }
        }); */

      }


      window.setInterval(getCoords, 5000);
