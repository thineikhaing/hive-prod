
%script{src: "//maps.google.com/maps/api/js?v=3.13&sensor=false&libraries=geometry", type: "text/javascript"}
%script{src: "//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js", type: "text/javascript"}
%script{src: "//google-maps-utility-library-v3.googlecode.com/svn/tags/infobox/1.1.9/src/infobox_packed.js", type: "text/javascript"}
%script{src: "https://google-maps-utility-library-v3.googlecode.com/svn-history/r293/trunk/richmarker/src/richmarker.js", type: "text/javascript" }

#map

:css
  html, body, #map-canvas {
    height: 100%;
    margin: 0px;
    padding: 0px
  }

:javascript
  // This example adds an animated symbol to a polyline.

  var line;

  function initialize() {
    var mapOptions = {
      center: new google.maps.LatLng(1.3200528, 103.8438445),
      zoom: 14,
      mapTypeId: google.maps.MapTypeId.TERRAIN
    };

    var map = new google.maps.Map(document.getElementById('map'),
        mapOptions);

    var lineCoordinates = [
      new google.maps.LatLng(1.3200528, 103.8438445),
      new google.maps.LatLng(1.3042924, 103.8324935)
    ];

    // Define the symbol, using one of the predefined paths ('CIRCLE')
    // supplied by the Google Maps JavaScript API.
    var lineSymbol = {
      path: google.maps.SymbolPath.CIRCLE,
      scale: 8,
    };

    // Create the polyline and add the symbol to it via the 'icons' property.
    line = new google.maps.Polyline({
      path: lineCoordinates,
      icons: [{
        icon: lineSymbol,
        offset: '100%'
      }],
      map: map
    });

    animateCircle();
  }

  // Use the DOM setInterval() function to change the offset of the symbol
  // at fixed intervals.
  function animateCircle() {
      var count = 0;
      window.setInterval(function() {
        count = (count + 1) % 200;

        var icons = line.get('icons');
        icons[0].offset = (count / 2) + '%';
        line.set('icons', icons);
    }, 20);
  }

  google.maps.event.addDomListener(window, 'load', initialize);
          
